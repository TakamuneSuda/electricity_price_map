import maplibregl from 'maplibre-gl';
import 'maplibre-gl/dist/maplibre-gl.css';

const hokkaido_price = {"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":10.35,"12:30":0.01,"12:00":0.01,"06:30":11.27,"08:30":0.01,"21:30":14.22,"16:30":10.84,"10:30":0.01,"01:30":11.08,"02:30":10.99,"19:00":14.72,"20:00":14.24,"00:30":13.99,"00:00":16.53,"13:00":0.01,"21:00":14.23,"17:30":14.79,"23:00":14.21,"08:00":0.01,"03:00":11.3,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":11.52,"11:00":0.01,"17:00":14.04,"20:30":14.24,"14:30":0.01,"22:00":14.38,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":14.22,"07:30":5.0,"01:00":11.83,"16:00":10.35,"15:00":1.0,"09:00":0.01,"02:00":11.02,"11:30":0.01,"15:30":5.0,"23:30":14.13,"04:00":13.33};

const price = {"kyushu":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":5.84,"12:30":0.01,"12:00":0.01,"06:30":9.62,"08:30":0.01,"21:30":11.1,"16:30":1.0,"10:30":0.01,"01:30":10.13,"02:30":5.84,"19:00":14.72,"20:00":14.24,"00:30":9.4,"00:00":5.84,"13:00":0.01,"21:00":13.13,"17:30":14.79,"23:00":10.17,"08:00":0.01,"03:00":6.0,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":7.0,"11:00":0.01,"17:00":8.18,"20:30":14.0,"14:30":0.01,"22:00":10.56,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":7.0,"09:30":0.01,"22:30":10.32,"07:30":0.01,"01:00":10.13,"16:00":0.01,"15:00":0.01,"09:00":0.01,"02:00":5.84,"11:30":0.01,"15:30":0.01,"23:30":10.8,"04:00":7.0},"chugoku":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":5.84,"12:30":0.01,"12:00":0.01,"06:30":9.62,"08:30":0.01,"21:30":11.1,"16:30":1.0,"10:30":0.01,"01:30":10.13,"02:30":10.0,"19:00":14.72,"20:00":14.24,"00:30":9.4,"00:00":5.84,"13:00":0.01,"21:00":13.13,"17:30":14.79,"23:00":10.17,"08:00":0.01,"03:00":10.13,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":10.2,"11:00":0.01,"17:00":8.18,"20:30":14.0,"14:30":0.01,"22:00":10.56,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":10.32,"07:30":0.01,"01:00":10.13,"16:00":0.01,"15:00":0.01,"09:00":0.01,"02:00":10.0,"11:30":0.01,"15:30":0.01,"23:30":10.8,"04:00":12.0},"hokuriku":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":5.84,"12:30":0.01,"12:00":0.01,"06:30":9.62,"08:30":0.01,"21:30":11.1,"16:30":1.0,"10:30":0.01,"01:30":10.13,"02:30":10.0,"19:00":14.72,"20:00":14.24,"00:30":9.4,"00:00":5.84,"13:00":0.01,"21:00":13.13,"17:30":14.79,"23:00":10.17,"08:00":0.01,"03:00":10.13,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":10.2,"11:00":0.01,"17:00":8.18,"20:30":14.0,"14:30":0.01,"22:00":10.56,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":10.32,"07:30":0.01,"01:00":10.13,"16:00":0.01,"15:00":0.01,"09:00":0.01,"02:00":10.0,"11:30":0.01,"15:30":0.01,"23:30":10.8,"04:00":12.0},"kansai":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":5.84,"12:30":0.01,"12:00":0.01,"06:30":9.62,"08:30":0.01,"21:30":11.1,"16:30":1.0,"10:30":0.01,"01:30":10.13,"02:30":10.0,"19:00":14.72,"20:00":14.24,"00:30":9.4,"00:00":5.84,"13:00":0.01,"21:00":13.13,"17:30":14.79,"23:00":10.17,"08:00":0.01,"03:00":10.13,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":10.2,"11:00":0.01,"17:00":8.18,"20:30":14.0,"14:30":0.01,"22:00":10.56,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":10.32,"07:30":0.01,"01:00":10.13,"16:00":0.01,"15:00":0.01,"09:00":0.01,"02:00":10.0,"11:30":0.01,"15:30":0.01,"23:30":10.8,"04:00":12.0},"tohoku":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":10.35,"12:30":0.01,"12:00":0.01,"06:30":11.27,"08:30":0.01,"21:30":14.22,"16:30":10.84,"10:30":0.01,"01:30":11.08,"02:30":10.99,"19:00":14.72,"20:00":14.24,"00:30":13.99,"00:00":14.68,"13:00":0.01,"21:00":14.23,"17:30":14.79,"23:00":14.21,"08:00":0.01,"03:00":11.3,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":11.52,"11:00":0.01,"17:00":14.04,"20:30":14.24,"14:30":0.01,"22:00":14.38,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":14.22,"07:30":6.0,"01:00":11.83,"16:00":10.35,"15:00":1.0,"09:00":0.01,"02:00":11.02,"11:30":0.01,"15:30":5.0,"23:30":14.13,"04:00":13.33},"tokyo":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":10.35,"12:30":0.01,"12:00":0.01,"06:30":11.27,"08:30":0.01,"21:30":14.22,"16:30":10.84,"10:30":0.01,"01:30":11.08,"02:30":10.99,"19:00":14.72,"20:00":14.24,"00:30":13.99,"00:00":14.68,"13:00":0.01,"21:00":14.23,"17:30":14.79,"23:00":14.21,"08:00":0.01,"03:00":11.3,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":11.52,"11:00":0.01,"17:00":14.04,"20:30":14.24,"14:30":0.01,"22:00":14.38,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":14.22,"07:30":6.0,"01:00":11.83,"16:00":10.35,"15:00":1.0,"09:00":0.01,"02:00":11.02,"11:30":0.01,"15:30":5.0,"23:30":14.13,"04:00":13.33},"system":{"05:30":14.22,"06:00":13.5,"14:00":0.01,"07:00":6.03,"12:30":0.01,"12:00":0.01,"06:30":10.37,"08:30":0.01,"21:30":10.8,"16:30":6.28,"10:30":0.01,"01:30":10.37,"02:30":10.35,"19:00":14.19,"20:00":12.42,"00:30":10.41,"00:00":10.48,"13:00":0.01,"21:00":10.98,"17:30":14.19,"23:00":10.88,"08:00":0.01,"03:00":10.37,"18:30":14.19,"13:30":0.01,"19:30":13.5,"03:30":10.41,"11:00":0.01,"17:00":10.49,"20:30":12.6,"14:30":0.01,"22:00":13.88,"05:00":13.15,"10:00":0.01,"18:00":13.6,"04:30":10.97,"09:30":0.01,"22:30":11.02,"07:30":1.0,"01:00":10.42,"16:00":3.0,"15:00":0.01,"09:00":0.01,"02:00":10.35,"11:30":0.01,"15:30":0.01,"23:30":10.72,"04:00":10.6},"shikoku":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":5.84,"12:30":0.01,"12:00":0.01,"06:30":9.62,"08:30":0.01,"21:30":11.1,"16:30":1.0,"10:30":0.01,"01:30":10.13,"02:30":10.0,"19:00":14.72,"20:00":14.24,"00:30":9.4,"00:00":5.84,"13:00":0.01,"21:00":13.13,"17:30":14.79,"23:00":10.17,"08:00":0.01,"03:00":10.13,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":10.2,"11:00":0.01,"17:00":8.18,"20:30":14.0,"14:30":0.01,"22:00":10.56,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":10.32,"07:30":0.01,"01:00":10.13,"16:00":0.01,"15:00":0.01,"09:00":0.01,"02:00":10.0,"11:30":0.01,"15:30":0.01,"23:30":10.8,"04:00":12.0},"hokkaido":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":10.35,"12:30":0.01,"12:00":0.01,"06:30":11.27,"08:30":0.01,"21:30":14.22,"16:30":10.84,"10:30":0.01,"01:30":11.08,"02:30":10.99,"19:00":14.72,"20:00":14.24,"00:30":13.99,"00:00":16.53,"13:00":0.01,"21:00":14.23,"17:30":14.79,"23:00":14.21,"08:00":0.01,"03:00":11.3,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":11.52,"11:00":0.01,"17:00":14.04,"20:30":14.24,"14:30":0.01,"22:00":14.38,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":14.22,"07:30":5.0,"01:00":11.83,"16:00":10.35,"15:00":1.0,"09:00":0.01,"02:00":11.02,"11:30":0.01,"15:30":5.0,"23:30":14.13,"04:00":13.33},"chubu":{"05:30":14.59,"06:00":14.24,"14:00":0.01,"07:00":10.35,"12:30":0.01,"12:00":0.01,"06:30":11.27,"08:30":0.01,"21:30":11.1,"16:30":1.0,"10:30":0.01,"01:30":11.08,"02:30":10.99,"19:00":14.72,"20:00":14.24,"00:30":13.99,"00:00":14.68,"13:00":0.01,"21:00":13.13,"17:30":14.79,"23:00":14.21,"08:00":0.01,"03:00":11.3,"18:30":14.82,"13:30":0.01,"19:30":14.31,"03:30":11.52,"11:00":0.01,"17:00":8.18,"20:30":14.0,"14:30":0.01,"22:00":14.38,"05:00":14.23,"10:00":0.01,"18:00":14.59,"04:30":14.21,"09:30":0.01,"22:30":14.22,"07:30":3.0,"01:00":11.83,"16:00":0.01,"15:00":0.01,"09:00":0.01,"02:00":11.02,"11:30":0.01,"15:30":0.01,"23:30":10.8,"04:00":13.33}};

var hokkaido_opa = 0.2;

var hokkaido_opa = Math.round((price['hokkaido']["00:00"] / 30) * 10) / 10;
var tohoku_opa = Math.round((price['tohoku']["00:00"] / 30) * 10) / 10;
var tokyo_opa = Math.round((price['tokyo']["00:00"] / 30) * 10) / 10;
var hokuriku_opa = Math.round((price['hokuriku']["00:00"] / 30) * 10) / 10;
var chubu_opa = Math.round((price['chubu']["00:00"] / 30) * 10) / 10;
var kansai_opa = Math.round((price['kansai']["00:00"] / 30) * 10) / 10;
var chugoku_opa = Math.round((price['chugoku']["00:00"] / 30) * 10) / 10;
var shikoku_opa = Math.round((price['shikoku']["00:00"] / 30) * 10) / 10;
var kyushu_opa = Math.round((price['kyushu']["00:00"] / 30) * 10) / 10;


const map = new maplibregl.Map({
  container: 'map',
  zoom: 4,
  center: [138, 37],
  minZoom: 1,
  maxZoom: 8,
  maxBounds: [122, 20, 154, 50],
  style: {
    version: 8,
    sources: {
      // background
      osm: {
        type: 'raster',
        tiles: ['http://tile.openstreetmap.org/{z}/{x}/{y}.png'],
        maxzoom: 8,
        tileSize: 256,
        attribution:
          '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
      },
      areamap: {
        type: 'geojson',
        data: '/public/out.geojson',
        attribution:
          '&copy; <a href="http://www.openstreetmap.org/copyright">aaa</a>',
      },
    },
    layers: [
      {
        id: 'osm-layer',
        source: 'osm',
        type: 'raster',
        paint: {
          'raster-opacity': 0.8
        }
      },
      {
        id: 'areamap-line-layer',
        type: 'line',
        source: 'areamap',
        layout: {},
        paint: {
          'line-color': '#000000',
          'line-width': 0.1
        }
      },
      {
        id: 'areamap-layer',
        type: 'fill',
        source: 'areamap',
        layout: {},
        paint: {
          'fill-color': '#ff0000',
          'fill-opacity': [
            'match',
            ['get', 'name'],
            'hokkaido', hokkaido_opa,
            'tohoku', tohoku_opa,
            'tokyo', tokyo_opa,
            'hokuriku', hokuriku_opa,
            'chubu', chubu_opa,
            'kansai', kansai_opa,
            'chugoku', chugoku_opa,
            'shikoku', shikoku_opa,
            'kyushu', kyushu_opa,
            0
          ],
        }
      },
    ]
  }});
  
  
$("#timeRange").on("input", function() {
  let value = $(this).val();
  let hours = Math.floor(value / 2);
  hours = hours < 10 ? "0" + hours : hours;
  let time = hours + ":" + (value % 2 === 0 ? "00" : "30");
  $("#time_label").text(time);
    
  hokkaido_opa = Math.round((price['hokkaido'][time] / 30) * 10) / 10;
  tohoku_opa = Math.round((price['tohoku'][time] / 30) * 10) / 10;
  tokyo_opa = Math.round((price['tokyo'][time] / 30) * 10) / 10;
  hokuriku_opa = Math.round((price['hokuriku'][time] / 30) * 10) / 10;
  chubu_opa = Math.round((price['chubu'][time] / 30) * 10) / 10;
  kansai_opa = Math.round((price['kansai'][time] / 30) * 10) / 10;
  chugoku_opa = Math.round((price['chugoku'][time] / 30) * 10) / 10;
  shikoku_opa = Math.round((price['shikoku'][time] / 30) * 10) / 10;
  kyushu_opa = Math.round((price['kyushu'][time] / 30) * 10) / 10;

  map.setPaintProperty('areamap-layer', 'fill-opacity', [
    'match',
    ['get', 'name'],
    'hokkaido', hokkaido_opa,
    'tohoku', tohoku_opa,
    'tokyo', tokyo_opa,
    'hokuriku', hokuriku_opa,
    'chubu', chubu_opa,
    'kansai', kansai_opa,
    'chugoku', chugoku_opa,
    'shikoku', shikoku_opa,
    'kyushu', kyushu_opa,
    0
  ]);
});
